{
  "$schema": "https://stina.app/schemas/extension-manifest.json",
  "id": "openai-provider",
  "name": "OpenAI AI Provider",
  "version": "1.0.8",
  "description": "Connect Stina to OpenAI's AI models including GPT-4o and reasoning models (o1, o3, o4-mini).",
  "type": "provider",
  "author": {
    "name": "Stina Team",
    "url": "https://github.com/einord"
  },
  "repository": "https://github.com/einord/stina-ext-openai",
  "license": "MIT",
  "engines": {
    "stina": ">=0.5.0"
  },
  "platforms": ["web", "electron", "tui"],
  "main": "index.js",

  "permissions": [
    "network:*",
    "provider.register",
    "actions.register",
    "events.emit",
    "secrets.manage"
  ],

  "contributes": {
    "providers": [
      {
        "id": "openai",
        "name": "OpenAI",
        "description": "GPT-4o, o1, o3, o4-mini, 5.2 and other OpenAI models",
        "suggestedDefaultModel": "gpt-5.2",
        "defaultSettings": {
          "authMethod": "api_key",
          "apiKey": "",
          "baseUrl": "https://api.openai.com/v1",
          "organizationId": "",
          "reasoningEffort": "medium"
        },
        "configSchema": {
          "order": ["authMethod", "apiKey", "baseUrl", "organizationId", "reasoningEffort"],
          "properties": {
            "authMethod": {
              "type": "select",
              "title": "Authentication Method",
              "description": "Choose how to authenticate with OpenAI.",
              "default": "api_key",
              "options": [
                { "value": "api_key", "label": "API Key" },
                { "value": "chatgpt_oauth", "label": "ChatGPT Login (Experimental)" }
              ]
            },
            "apiKey": {
              "type": "password",
              "title": "API Key",
              "description": "Your OpenAI API key",
              "placeholder": "sk-...",
              "visibleWhen": { "authMethod": "api_key" }
            },
            "baseUrl": {
              "type": "url",
              "title": "Base URL",
              "description": "API base URL (for proxies/custom endpoints)",
              "placeholder": "https://api.openai.com/v1",
              "default": "https://api.openai.com/v1"
            },
            "organizationId": {
              "type": "string",
              "title": "Organization ID",
              "description": "Optional OpenAI Organization ID",
              "placeholder": "org-..."
            },
            "reasoningEffort": {
              "type": "select",
              "title": "Reasoning Effort",
              "description": "Controls reasoning depth for models that support it. Set to None to disable.",
              "default": "none",
              "options": [
                { "value": "none", "label": "None" },
                { "value": "low", "label": "Low" },
                { "value": "medium", "label": "Medium" },
                { "value": "high", "label": "High" }
              ]
            }
          }
        }
      }
    ],
    "toolSettings": [
      {
        "id": "chatgpt-oauth",
        "title": "ChatGPT Account",
        "description": "Connect your ChatGPT account to use your subscription instead of API billing.",
        "view": {
          "kind": "component",
          "data": {
            "oauthState": {
              "action": "getOAuthState",
              "refreshOn": ["openai.oauth.changed"]
            }
          },
          "content": {
            "component": "VerticalStack",
            "gap": 1,
            "children": [
              {
                "component": "ConditionalGroup",
                "condition": "$oauthState.status == 'disconnected'",
                "children": [
                  {
                    "component": "VerticalStack",
                    "gap": 0.5,
                    "children": [
                      {
                        "component": "Label",
                        "text": "Experimental: Sign in with your ChatGPT account to use your Plus/Pro subscription.",
                        "style": { "opacity": "0.7", "font-size": "0.9em" }
                      },
                      {
                        "component": "Button",
                        "text": "Connect ChatGPT Account",
                        "onClickAction": "startChatGPTOAuth"
                      }
                    ]
                  }
                ]
              },
              {
                "component": "ConditionalGroup",
                "condition": "$oauthState.status == 'awaiting'",
                "children": [
                  {
                    "component": "VerticalStack",
                    "gap": 0.5,
                    "children": [
                      {
                        "component": "Label",
                        "text": "Go to the URL below and enter the code:"
                      },
                      {
                        "component": "Label",
                        "text": "$oauthState.verificationUrl",
                        "style": { "font-family": "monospace", "word-break": "break-all" }
                      },
                      {
                        "component": "Label",
                        "text": "$oauthState.userCode",
                        "style": { "font-size": "1.5em", "font-weight": "bold", "text-align": "center" }
                      }
                    ]
                  }
                ]
              },
              {
                "component": "ConditionalGroup",
                "condition": "$oauthState.status == 'connected'",
                "children": [
                  {
                    "component": "HorizontalStack",
                    "gap": 0.5,
                    "style": { "align-items": "center" },
                    "children": [
                      {
                        "component": "Pill",
                        "text": "Connected",
                        "variant": "success"
                      },
                      {
                        "component": "Button",
                        "text": "Disconnect",
                        "type": "danger",
                        "onClickAction": "disconnectChatGPTOAuth"
                      }
                    ]
                  }
                ]
              },
              {
                "component": "ConditionalGroup",
                "condition": "$oauthState.status == 'error'",
                "children": [
                  {
                    "component": "VerticalStack",
                    "gap": 0.5,
                    "children": [
                      {
                        "component": "HorizontalStack",
                        "gap": 0.5,
                        "style": { "align-items": "center" },
                        "children": [
                          {
                            "component": "Pill",
                            "text": "Error",
                            "variant": "danger"
                          },
                          {
                            "component": "Label",
                            "text": "$oauthState.errorMessage",
                            "style": { "opacity": "0.8", "font-size": "0.9em" }
                          }
                        ]
                      },
                      {
                        "component": "Button",
                        "text": "Retry",
                        "onClickAction": "startChatGPTOAuth"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        }
      }
    ]
  }
}
